<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Peg by Peg – Trainer (Leapfrog-correct)</title>
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Lora:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#efe6d6; --paper:#fffaf1; --ink:#3e2723; --ink2:#5d4037;
    --wood:#8b5a2b; --frame:#5d4037; --accent:#c49a6c;
    --p1:#c0392b; --p2:#2980b9; --ok:#2e7d32; --warn:#b71c1c;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Lora,serif;background:var(--bg);color:var(--ink)}
  .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
  h1{font:700 1.6rem Merriweather;margin:0 0 10px}
  .card{background:var(--paper);border:1px solid #e3d6be;border-radius:12px;padding:14px 16px;box-shadow:0 2px 8px rgba(0,0,0,.06);margin:0 0 14px}
  .row{display:flex;gap:16px;flex-wrap:wrap}
  .col{flex:1 1 420px}
  .muted{color:#6d584a}

  /* Board shell */
  .board{background:var(--wood);border:8px solid var(--frame);border-radius:16px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,.35),inset 0 0 10px rgba(0,0,0,.25)}
  .track{position:relative;height:74px;margin:18px 0;border:2px solid var(--frame);background:#d2b48c;border-radius:10px;box-shadow:inset 0 0 6px rgba(0,0,0,.25)}
  .label{position:absolute;top:-18px;left:6px;font:700 .82rem Merriweather;color:#fff;text-shadow:0 1px 1px rgba(0,0,0,.35)}
  /* holes + number line */
  .lane{position:absolute;left:12px;right:12px;top:36px;height:6px;background:rgba(0,0,0,.22);border-radius:4px}
  .ticks{position:absolute;left:12px;right:12px;top:20px;height:0;display:flex;justify-content:space-between;pointer-events:none}
  .tick{position:relative;width:1px;height:18px;background:#3b2618;opacity:.75}
  .tick.small{height:10px;opacity:.55}
  .tlabel{position:absolute;top:-18px;left:50%;transform:translateX(-50%);font:700 .72rem Merriweather;color:#2c1b12}

  /* Pegs */
  .peg{position:absolute;top:22px;width:26px;height:26px;border-radius:50%;border:2px solid #fff;
        box-shadow:0 2px 5px rgba(0,0,0,.35),inset 0 0 4px rgba(255,255,255,.55);transition:left .22s ease-out}
  .peg.p1{background:var(--p1)} .peg.p2{background:var(--p2)}
  .peg.hop{animation:hop .25s ease-out}
  @keyframes hop{0%{transform:translateY(0)}40%{transform:translateY(-16px)}100%{transform:translateY(0)}}

  /* Controls */
  .controls button{margin:.25rem .25rem 0 0}
  .btn{appearance:none;border:1px solid #c9b693;background:#fff;padding:.45rem .7rem;border-radius:.5rem;cursor:pointer;font:600 .95rem Merriweather}
  .btn.primary{background:var(--accent);color:#fff;border-color:var(--frame)}
  .select{padding:.35rem .5rem;border:1px solid #c9b693;border-radius:.45rem;background:#fff}
  .status{margin-top:.5rem;font-weight:700;font-family:ui-monospace,SFMono-Regular,Menlo,monospace}
  .ok{color:var(--ok)} .warn{color:var(--warn)}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Peg by Peg – Trainer Board (Leapfrog Logic)</h1>

    <div class="row">
      <div class="col">
        <div class="card">
          <div style="display:flex;gap:.5rem;align-items:center;margin-bottom:.4rem">
            <label>Track:</label>
            <select id="trackSel" class="select">
              <option value="30">0–30</option>
              <option value="61">0–61</option>
              <option value="121" selected>0–121</option>
            </select>
            <button id="applyBtn" class="btn primary">Apply</button>
          </div>

          <div class="board">
            <!-- Player 1 -->
            <div class="track" id="t1">
              <div class="label">P1</div>
              <div class="ticks" id="ticks1"></div>
              <div class="lane"></div>
              <div class="peg p1" id="p1Front"></div>
              <div class="peg p1" id="p1Back"></div>
            </div>
            <!-- Player 2 -->
            <div class="track" id="t2">
              <div class="label">P2</div>
              <div class="ticks" id="ticks2"></div>
              <div class="lane"></div>
              <div class="peg p2" id="p2Front"></div>
              <div class="peg p2" id="p2Back"></div>
            </div>
          </div>

          <div class="controls">
            <p class="muted">Scoring buttons (teaching stand-ins for “you scored N”). Only the **back peg moves**; it jumps to <em>front + N</em>, then pegs swap roles.</p>
            <div><strong>P1:</strong>
              <button class="btn" data-play="1-1">+1</button>
              <button class="btn" data-play="1-2">+2</button>
              <button class="btn" data-play="1-3">+3</button>
              <button class="btn" data-play="1-4">+4</button>
              <button class="btn" data-play="1-5">+5</button>
            </div>
            <div><strong>P2:</strong>
              <button class="btn" data-play="2-1">+1</button>
              <button class="btn" data-play="2-2">+2</button>
              <button class="btn" data-play="2-3">+3</button>
              <button class="btn" data-play="2-4">+4</button>
              <button class="btn" data-play="2-5">+5</button>
            </div>
            <div style="margin-top:.4rem">
              <button id="resetBtn" class="btn">New Game</button>
            </div>
            <div id="status" class="status"></div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card">
          <h3>Number-line Behavior</h3>
          <ol class="muted">
            <li>Each lane shows a **number line** with labels every 5 and minor ticks each hole.</li>
            <li>On a score of <em>N</em>, the **back peg** jumps to **front + N** (front stays), then pegs swap roles.</li>
            <li>The peg left behind is the “safe” total you came from; the peg ahead is your new total.</li>
          </ol>
          <p class="muted">This mirrors how students perceive totals: “we were at 7, scored 2, now we’re at 9.”</p>
        </div>
      </div>
    </div>
  </div>

<script>
/* ------------ State ------------ */
const S = {
  max:121,
  players:{
    1:{front:0, back:0}, // front = current total, back = previous total
    2:{front:0, back:0}
  },
  spacing:6
};

const el = {
  trackSel: document.getElementById('trackSel'),
  applyBtn:  document.getElementById('applyBtn'),
  resetBtn:  document.getElementById('resetBtn'),
  status:    document.getElementById('status'),
  ticks1:    document.getElementById('ticks1'),
  ticks2:    document.getElementById('ticks2'),
  p1Front:   document.getElementById('p1Front'),
  p1Back:    document.getElementById('p1Back'),
  p2Front:   document.getElementById('p2Front'),
  p2Back:    document.getElementById('p2Back'),
  t1:        document.getElementById('t1')
};

/* ------------ Layout helpers ------------ */
function buildTicks(container){
  container.innerHTML = '';
  for(let i=0;i<=S.max;i++){
    const d = document.createElement('div');
    d.className = 'tick' + (i%5===0 ? '' : ' small');
    if(i%5===0){
      const lab = document.createElement('div');
      lab.className = 'tlabel';
      lab.textContent = i.toString();
      d.appendChild(lab);
    }
    container.appendChild(d);
  }
}
function recalcSpacing(){
  const inner = el.t1.clientWidth - 24; // 12px padding each side
  S.spacing = inner / S.max;
  placeAll();
}
function leftPx(val){ return (12 + val * S.spacing) + 'px'; } // 12px left inset

/* ------------ Peg placement ------------ */
function place(p, which, val){
  const peg = (p===1)
    ? (which==='front' ? el.p1Front : el.p1Back)
    : (which==='front' ? el.p2Front : el.p2Back);
  peg.style.left = leftPx(val);
}
function placeAll(){
  place(1,'front',S.players[1].front);
  place(1,'back', S.players[1].back);
  place(2,'front',S.players[2].front);
  place(2,'back', S.players[2].back);
}

/* ------------ Core “leapfrog” move ------------ */
/* On score N:
   - Only the BACK peg moves.
   - It jumps to (front + N), clamped to max.
   - Then pegs swap roles (moved peg becomes FRONT).
*/
function score(p, n){
  const P = S.players[p];
  const target = Math.min(S.max, P.front + n);
  // move the back peg to target
  P.back = target;
  // animate the peg that moved (the one that WAS back)
  const hopPeg = (p===1? el.p1Back : el.p2Back);
  hopPeg.classList.add('hop');
  setTimeout(()=>hopPeg.classList.remove('hop'), 240);

  // swap roles: the peg at 'target' is now the front (current total),
  // the previous front becomes the back (safe).
  const oldFront = P.front;
  P.front = P.back;
  P.back  = oldFront;

  placeAll();
  say(`P${p}: +${n} → new total ${P.front} (safe peg at ${P.back}).`);
}

/* ------------ UI wiring ------------ */
function apply(){
  S.max = parseInt(el.trackSel.value,10);
  buildTicks(el.ticks1);
  buildTicks(el.ticks2);
  reset();
}
function reset(){
  S.players[1].front=S.players[1].back=0;
  S.players[2].front=S.players[2].back=0;
  placeAll();
  say('New game. Both pegs start at 0 (front and back overlap).');
}
function say(msg, cls=''){
  el.status.className = 'status ' + cls;
  el.status.textContent = msg;
}

document.querySelectorAll('[data-play]').forEach(b=>{
  b.addEventListener('click',()=>{
    const [p,v] = b.dataset.play.split('-').map(Number);
    score(p, v);
  });
});
el.applyBtn.addEventListener('click', apply);
el.resetBtn.addEventListener('click', reset);
window.addEventListener('resize', recalcSpacing);

/* init */
apply();
recalcSpacing();
</script>
</body>
</html>
